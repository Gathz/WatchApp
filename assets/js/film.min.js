const tmdbDiscover="movie",API_KEY="api_key=59a196db85cf15d1d2d05b1fd481f431&language=it-IT&region=IT&include_adult=true",BASE_URL="https://api.themoviedb.org/3",API_URL=BASE_URL+"/discover/"+tmdbDiscover+"?latest&"+API_KEY,IMG_URL="https://image.tmdb.org/t/p/w500",searchURL=BASE_URL+"/search/movie?"+API_KEY,genres=[{id:28,name:"Azione"},{id:12,name:"Avventura"},{id:16,name:"Animazione"},{id:35,name:"Commedia"},{id:80,name:"Crime"},{id:99,name:"Documentario"},{id:18,name:"Dramma"},{id:10751,name:"Famiglia"},{id:14,name:"Fantasy"},{id:36,name:"Storia"},{id:27,name:"Horror"},{id:10402,name:"Musica"},{id:9648,name:"Mistero"},{id:10749,name:"Romance"},{id:878,name:"Fantascienza"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"Guerra"},{id:37,name:"Western"}],main=document.getElementById("main"),formSearchFilter=document.getElementById("formSearchFilter"),search=document.getElementById("searchFilter"),tagsEl=document.getElementById("tags"),prev=document.getElementById("prev"),next=document.getElementById("next"),current=document.getElementById("current");var currentPage=1,nextPage=2,prevPage=3,lastUrl="",totalPages=100,selectedGenre=[];function setGenre(){tagsEl.innerHTML="",genres.forEach(a=>{const e=document.createElement("div");e.classList.add("tag"),e.id=a.id,e.innerText=a.name,e.addEventListener("click",()=>{0!=selectedGenre.length&&selectedGenre.includes(a.id)?selectedGenre.forEach((e,t)=>{e==a.id&&selectedGenre.splice(t,1)}):selectedGenre.push(a.id),getMovies(API_URL+"&with_genres="+encodeURI(selectedGenre.join(","))),highlightSelection()}),tagsEl.append(e)})}function highlightSelection(){const e=document.querySelectorAll(".tag");e.forEach(e=>{e.classList.remove("highlight")}),clearBtn(),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),0!=selectedGenre.length&&selectedGenre.forEach(e=>{const t=document.getElementById(e);t.classList.add("highlight"),$("#filterBtn").addClass("hasFilter")})}function clearBtn(){let e=document.getElementById("clear");if(e)e.classList.add("highlight");else{let e=document.createElement("div");e.classList.add("tag","highlight"),e.id="clear",e.innerText="Clear x",e.addEventListener("click",()=>{selectedGenre=[],setGenre(),getMovies(API_URL),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$("#filterBtn").removeClass("hasFilter")}),tagsEl.append(e)}}function getMovies(e){lastUrl=e,fetch(e).then(e=>e.json()).then(e=>{0!==e.results.length?(showMovies(e.results),currentPage=e.page,nextPage=currentPage+1,prevPage=currentPage-1,totalPages=e.total_pages,(current.innerText=currentPage)<=1?(prev.classList.add("disabled"),next.classList.remove("disabled")):totalPages<=currentPage?(prev.classList.remove("disabled"),next.classList.add("disabled")):(prev.classList.remove("disabled"),next.classList.remove("disabled"))):main.innerHTML='<h1 class="no-results">No Results Found</h1>'})}function showMovies(e){main.innerHTML="",e.forEach(e=>{var{title:t,poster_path:a,id:e}=e;const i=document.createElement("div");i.classList.add("mainWrapper","col-6","col-md-4","col-lg-3","col-xl-2"),i.innerHTML=`
            <div id="${e}" class="movie movie-${e} skeleton">
              <div class="movie--content">
                <div class="skeletonImg">
                    <div class="svg">
                        <svg version="1.1" class="svg--element" viewBox="0 0 65 65" style="enable-background:new 0 0 65 65;" xml:space="preserve">
                            <path class="Fill(XXVVI)" d="M56.3,45l-8.7-10.5c-1.4-1.6-3.9-1.6-5.2,0l-2.7,3.2l-9.8-11.7c-1.4-1.7-4-1.7-5.5,0L8.8,44.9c-1.9,2.3-0.3,5.8,2.7,5.8
                            h31.3c0.3,0,0.5,0,0.7-0.1h10.1C56.5,50.6,58.1,47.2,56.3,45z"/>
                            <circle class="Fill(XXVVI)" cx="40.2" cy="20.7" r="6.3"/>
                        </svg>
                    </div>
                </div>
                <div class="movie--indicator">
                  <div class="svg">
                    <svg version="1.1" class="svg--element" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10;" xml:space="preserve">
                      <path d="M8.3,2.6C8,2.3,7.5,2.3,7.2,2.6L4,5.8L2.8,4.6C2.5,4.3,2,4.3,1.7,4.6c-0.3,0.3-0.3,0.8,0,1.1l1.8,1.8C3.6,7.6,3.8,7.6,4,7.6
                      	c0,0,0,0,0,0s0,0,0,0c0.2,0,0.4-0.1,0.5-0.2l3.8-3.8C8.6,3.4,8.6,2.9,8.3,2.6z"/>
                    </svg>
                  </div>
                </div>
                <div class="wrapper">
                  <div class="wrapperData d-none"></div>
                  <div class="wrapperData d-none">${e}</div>
                  <div class="wrapperData d-none">${t}</div>
                  <div class="wrapperData d-none">${a?IMG_URL+a:"http://placehold.jp/100/080e17/FFFFFF/1080x1580.jpg?text="+t+"&css=%7b%22padding-left%22%3a%22140px%22%2c%22padding-right%22%3a%22140px%22%7d"}</div>
                  <div class="wrapperData d-none"></div>
                  <div class="wrapperData d-none"></div>
                  <button class="addMovieBtn" onclick="recordEdit(this)">
                    <div class="addMovieBtn--text">
                      <span>
                        Aggiungi a una lista
                      </span>
                    </div>
                    <div class="addMovieBtn--icon">
                      <div class="svg">
                          <svg version="1.1" class="svg--element" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">
                              <path d="M23.2,16.5h-3.8v-3.8c0-0.8-0.7-1.5-1.5-1.5s-1.5,0.7-1.5,1.5v3.7h-3.7c-0.8,0-1.5,0.7-1.5,1.5s0.7,1.5,1.5,1.5h3.7v3.8
                            c0,0.8,0.7,1.5,1.5,1.5s1.5-0.7,1.5-1.5l0,0v-3.8h3.8c0.8,0,1.5-0.7,1.5-1.5S24,16.5,23.2,16.5L23.2,16.5z"/>
                          </svg>
                      </div>
                    </div>
                  </button>
                </div>
                <!-- <img src="${a?IMG_URL+a:"http://via.placeholder.com/1080x1580"}" alt="${t}"> -->
                <!-- <img src="${a?IMG_URL+a:"http://via.placeholder.com/1080x1580/080e17/FFFFFF?text="+t}" alt="${t}"> -->
                <img class="movieImg" src="${a?IMG_URL+a:"http://placehold.jp/100/080e17/FFFFFF/1080x1580.jpg?text="+t+"&css=%7b%22padding-left%22%3a%22140px%22%2c%22padding-right%22%3a%22140px%22%7d"}" alt="${t}">
              </div>

              <!-- <div class="movie--info">
                  <h3>${t}</h3>
              </div> -->

            </div>
        `,main.appendChild(i)}),$(".movieImg").load(function(){$(this).parent().parent(".skeleton").removeClass("skeleton")})}function pageCall(e){let t=lastUrl.split("?"),a=t[1].split("&"),i=a[a.length-1].split("=");"page"!=i[0]?getMovies(lastUrl+"&page="+e):(i[1]=e.toString(),e=i.join("="),a[a.length-1]=e,e=a.join("&"),getMovies(t[0]+"?"+e))}setGenre(),getMovies(API_URL),formSearchFilter.addEventListener("submit",e=>{e.preventDefault();e=search.value;selectedGenre=[],setGenre(),e?($("#loading").removeClass("hide"),getMovies(searchURL+"&query="+e),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$("#clearFilter").addClass("show")):($("#loading").removeClass("hide"),getMovies(API_URL),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$("#clearFilter").removeClass("show"))}),$("#clearFilter").click(function(){$("#loading").removeClass("hide"),$("#searchFilter").val(""),getMovies(API_URL),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$(this).removeClass("show")}),prev.addEventListener("click",()=>{0<prevPage&&(pageCall(prevPage),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click())}),next.addEventListener("click",()=>{nextPage<=totalPages&&(pageCall(nextPage),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click())}),$("#filterBtn").click(function(){MicroModal.show("modalTags")}),$("#modalTags-close").click(function(){MicroModal.close("modalTags")});var request,APP_URL="",rewatchItems="";function getStorageAPI(){localStorage.getItem("api_film");(APP_URL=localStorage.getItem("api_film"))&&($("#logout").css("display",""),$("#lists").css("display",""))}function getTotalRewatchItems(){rewatchItems=localStorage.getItem("filmRewatchItems"),console.log(rewatchItems),0<rewatchItems&&null!=rewatchItems&&(writeTotalRewatchItems(rewatchItems),setTimeout(function(){$(".itemCounter").addClass("show")},500))}function writeTotalRewatchItems(e){parseInt($(".itemCounter").text(e))}function recordEdit(e){MicroModal.show("modalWatchlist"),$("#modalWatchlist-close").click(function(){MicroModal.close("modalWatchlist")}),resetForm();var t=[];$(e).closest(".wrapper").find("div").each(function(){t.push($(this).text())}),$("#formCreate_watchlist #tid").val(t[0]),$("#formCreate_watchlist #movie_id").val(t[1]),$("#formCreate_watchlist #title").val(t[2]),$("#formCreate_watchlist #poster_path").val(t[3]),$("#formCreate_watchlist #watched").val(t[4]),$("#formCreate_watchlist #link").val(t[5]),$("#formCreate_watched #tid_watched").val(t[0]),$("#formCreate_watched #movie_id_watched").val(t[1]),$("#formCreate_watched #title_watched").val(t[2]),$("#formCreate_watched #poster_path_watched").val(t[3]),$("#formCreate_watched #watched_watched").val(t[4]),$("#formCreate_watched #link_watched").val(t[5]),$("#formCreate_rewatch #tid_rewatch").val(t[0]),$("#formCreate_rewatch #movie_id_rewatch").val(t[1]),$("#formCreate_rewatch #title_rewatch").val(t[2]),$("#formCreate_rewatch #poster_path_rewatch").val(t[3]),$("#formCreate_rewatch #watched_rewatch").val(t[4]),$("#formCreate_rewatch #link_rewatch").val(t[5]),$("#modalWatchlist-title").text(t[2])}function resetForm(){$("#formCreate_watchlist")[0].reset(),$("#formCreate_watched")[0].reset(),$("#formCreate_rewatch")[0].reset(),$("#watchedPlaceholder").val(""),$("#linkPlaceholder").val("")}function onChange(){var e=$("#watchedPlaceholder"),t=$("#linkPlaceholder"),a=$("#watched"),i=$("#watched_watched"),l=$("#watched_rewatch"),c=$("#link"),s=$("#link_watched"),o=$("#link_rewatch");a.val(e.val()),i.val(e.val()),l.val(e.val()),c.val(t.val()),s.val(t.val()),o.val(t.val())}function removeAPI(){localStorage.removeItem("api_film"),localStorage.removeItem("api_serie"),localStorage.removeItem("filmRewatchItems"),localStorage.removeItem("serieRewatchItems")}function checkLoading(){setTimeout(function(){$("#loading").hasClass("hide")?console.log("abort"):($("#loading").addClass("hide"),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$("#btnRetrieve_rewatch").click(),$("#btnRetrieveList").click())},5e3)}$(window).load(function(){getStorageAPI(),$("#btnRetrieve_watchlist").click(),$("#btnRetrieve_watched").click(),$("#btnRetrieve_rewatch").click(),$("#btnRetrieveList").click(),checkLoading()}),$("#formCreate_watchlist").submit(function(e){request&&request.abort();var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),$("#resultSubmit_watchlist").addClass("show"),$("#loading").removeClass("hide"),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){MicroModal.close("modalWatchlist"),$("#modalWatchlist-title").text(""),$("#resultSubmit_watchlist").removeClass("show"),resetForm(),$("#btnRetrieve_watchlist").click(),checkLoading()}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a),checkLoading()}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formCreate_watched").submit(function(e){request&&request.abort();var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),$("#resultSubmit_watched").addClass("show"),$("#loading").removeClass("hide"),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){MicroModal.close("modalWatchlist"),$("#modalWatchlist-title").text(""),$("#resultSubmit_watched").removeClass("show"),resetForm(),$("#btnRetrieve_watched").click(),checkLoading()}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a),checkLoading()}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formCreate_rewatch").submit(function(e){request&&request.abort();var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),$("#resultSubmit_rewatch").addClass("show"),$("#loading").removeClass("hide"),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){MicroModal.close("modalWatchlist"),$("#modalWatchlist-title").text(""),$("#resultSubmit_rewatch").removeClass("show"),resetForm(),$("#btnRetrieve_rewatch").click();var i=parseInt(rewatchItems,10)+1;localStorage.setItem("filmRewatchItems",i),writeTotalRewatchItems(i),getTotalRewatchItems(),checkLoading()}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a),checkLoading()}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formRetrieve_watchlist").submit(function(e){var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){e=e.values;$.each(e,function(e,t){0==e||$("#"+t[1]).addClass("movie--toWatch")})}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formRetrieve_watched").submit(function(e){var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){e=e.values;$.each(e,function(e,t){0==e||$("#"+t[1]).addClass("movie--watched")}),$("#loading").addClass("hide")}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formRetrieve_rewatch").submit(function(e){var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){e=e.values;objectLenght=Object.keys(e).length,objectLenghtInteger=parseInt(objectLenght,10),objectLenghtResult=objectLenghtInteger-1,localStorage.setItem("filmRewatchItems",objectLenghtResult),getTotalRewatchItems(),$.each(e,function(e,t){})}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formRetrieveList").submit(function(l){var e=$(this),c=e.find("input, select, button, textarea"),e=e.serialize();c.prop("disabled",!0),(request=$.ajax({url:"https://script.google.com/macros/s/AKfycbwcTIdyRkPyXgbnnlaWKMNfWRT6Bs1i559kugCa1brQb-VY2FP3/exec",type:"post",data:e})).done(function(e,t,a){var e=e.values,i="";$.each(e,function(e,t){var a="";0!=e?(a+='<div class="listItem">',a+='<a class="" href="'+t[1]+'" target="_blank">',a+='<div class="listItem__caption">'+t[0]+"</div>",a+='<div class="listItem__icon"><div class="svg"><svg version="1.1" class="svg--element" viewBox="0 0 65 65" style="enable-background:new 0 0 65 65;" xml:space="preserve"><path class="Fill(XII)" d="M48.8,32.4c-1.6-0.3-3.2,0.8-3.5,2.4c-0.5,2.6-1.7,5-3.6,6.9c-5.1,5.1-13.3,5.1-18.4,0c-5.1-5.1-5.1-13.3,0-18.4c1.9-1.9,4.2-3.1,6.9-3.6c1.6-0.3,2.7-1.9,2.4-3.5c-0.3-1.6-1.9-2.7-3.5-2.4c-3.8,0.7-7.3,2.5-10,5.3c-7.4,7.4-7.4,19.5,0,26.9c3.7,3.7,8.6,5.6,13.4,5.6c4.9,0,9.7-1.9,13.4-5.6c2.7-2.7,4.6-6.2,5.3-10C51.6,34.2,50.5,32.7,48.8,32.4z"/><path class="Fill(XII)" d="M52.6,15.1c0-1.2-0.8-2.3-1.8-2.8c-0.4-0.2-0.8-0.2-1.2-0.2c0,0,0,0,0,0H40c-1.7,0-3,1.3-3,3s1.3,3,3,3h2.3L34.4,26c-1.2,1.2-1.2,3.1,0,4.2c0.6,0.6,1.4,0.9,2.1,0.9s1.5-0.3,2.1-0.9l7.9-7.9v2.3c0,1.7,1.3,3,3,3s3-1.3,3-3L52.6,15.1C52.6,15.1,52.6,15.1,52.6,15.1z"/></svg></div></div>',a+="</a>",a+="</div>"):a+="",i+=0<e?'<div class="mainWrapper2">'+a+"</div>":"",request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){c.prop("disabled",!1)}),l.preventDefault()}),$("#modalLists-content").html(i),$("#messageRetrieve").text(""),$("#loading").addClass("hide"),checkLoading()}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){c.prop("disabled",!1)}),l.preventDefault()}),$("#watchedPlaceholder").change(onChange).keyup(onChange),$("#linkPlaceholder").change(onChange).keyup(onChange),$("#modalLogout-logout").click(function(){removeAPI(),$("#username").val(""),$("#password").val(""),MicroModal.close("modalLogout"),setTimeout(function(){var e=window.location.origin;window.location.replace(e+"/WatchApp")},500)}),$("#logout").click(function(){MicroModal.show("modalLogout")}),$("#modalLogout-close").click(function(){MicroModal.close("modalLogout")}),$("#modalLogout-cancel").click(function(){MicroModal.close("modalLogout")}),$("#lists").click(function(){MicroModal.show("modalLists")}),$("#modalLists-close").click(function(){MicroModal.close("modalLists")}),$("#modalLists-cancel").click(function(){MicroModal.close("modalLists")});
//# sourceMappingURL=film.min.js.map
