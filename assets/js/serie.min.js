const tmdbDiscover="tv",API_KEY="api_key=59a196db85cf15d1d2d05b1fd481f431&language=it-IT&region=IT&include_adult=true",BASE_URL="https://api.themoviedb.org/3",API_URL=BASE_URL+"/discover/"+tmdbDiscover+"?latest&"+API_KEY,IMG_URL="https://image.tmdb.org/t/p/w500",searchURL=BASE_URL+"/search/"+tmdbDiscover+"?"+API_KEY,genres=[{id:28,name:"Azione"},{id:12,name:"Avventura"},{id:16,name:"Animazione"},{id:35,name:"Commedia"},{id:80,name:"Crime"},{id:99,name:"Documentario"},{id:18,name:"Dramma"},{id:10751,name:"Famiglia"},{id:14,name:"Fantasy"},{id:36,name:"Storia"},{id:27,name:"Horror"},{id:10402,name:"Musica"},{id:9648,name:"Mistero"},{id:10749,name:"Romance"},{id:878,name:"Fantascienza"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"Guerra"},{id:37,name:"Western"}],scrolltToView=document.getElementById("containerToWatch"),main=document.getElementById("main"),formSearchFilter=document.getElementById("formSearchFilter"),search=document.getElementById("searchFilter"),tagsEl=document.getElementById("tags"),prev=document.getElementById("prev"),next=document.getElementById("next"),current=document.getElementById("current");var currentPage=1,nextPage=2,prevPage=3,lastUrl="",totalPages=100,selectedGenre=[];function setGenre(){tagsEl.innerHTML="",genres.forEach(a=>{const e=document.createElement("div");e.classList.add("tag"),e.id=a.id,e.innerText=a.name,e.addEventListener("click",()=>{0!=selectedGenre.length&&selectedGenre.includes(a.id)?selectedGenre.forEach((e,t)=>{e==a.id&&selectedGenre.splice(t,1)}):selectedGenre.push(a.id),getMovies(API_URL+"&with_genres="+encodeURI(selectedGenre.join(","))),highlightSelection()}),tagsEl.append(e)})}function highlightSelection(){const e=document.querySelectorAll(".tag");e.forEach(e=>{e.classList.remove("highlight")}),clearBtn(),$("#btnRetrieve").click(),0!=selectedGenre.length&&selectedGenre.forEach(e=>{const t=document.getElementById(e);t.classList.add("highlight"),$("#filterBtn").addClass("hasFilter")})}function clearBtn(){let e=document.getElementById("clear");if(e)e.classList.add("highlight");else{let e=document.createElement("div");e.classList.add("tag","highlight"),e.id="clear",e.innerText="Clear x",e.addEventListener("click",()=>{selectedGenre=[],setGenre(),getMovies(API_URL),$("#btnRetrieve").click(),$("#filterBtn").removeClass("hasFilter")}),tagsEl.append(e)}}function getMovies(e){lastUrl=e,fetch(e).then(e=>e.json()).then(e=>{0!==e.results.length?(showMovies(e.results),currentPage=e.page,nextPage=currentPage+1,prevPage=currentPage-1,totalPages=e.total_pages,(current.innerText=currentPage)<=1?(prev.classList.add("disabled"),next.classList.remove("disabled")):totalPages<=currentPage?(prev.classList.remove("disabled"),next.classList.add("disabled")):(prev.classList.remove("disabled"),next.classList.remove("disabled")),scrolltToView.scrollIntoView({behavior:"smooth"})):main.innerHTML='<h1 class="no-results">No Results Found</h1>'})}function showMovies(e){main.innerHTML="",e.forEach(e=>{var{name:t,poster_path:a,id:e}=e;const i=document.createElement("div");i.classList.add("mainWrapper","col-6","col-md-4","col-lg-3","col-xl-2"),i.innerHTML=`
            <div id="${e}" class="movie movie-${e}">
              <div class="movie--content">
                <div class="movie--indicator">
                  <div class="svg">
                    <svg version="1.1" class="svg--element" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10;" xml:space="preserve">
                      <path d="M8.3,2.6C8,2.3,7.5,2.3,7.2,2.6L4,5.8L2.8,4.6C2.5,4.3,2,4.3,1.7,4.6c-0.3,0.3-0.3,0.8,0,1.1l1.8,1.8C3.6,7.6,3.8,7.6,4,7.6
                      	c0,0,0,0,0,0s0,0,0,0c0.2,0,0.4-0.1,0.5-0.2l3.8-3.8C8.6,3.4,8.6,2.9,8.3,2.6z"/>
                    </svg>
                  </div>
                </div>
                <div class="wrapper">
                  <div class="wrapperData d-none"></div>
                  <div class="wrapperData d-none">${e}</div>
                  <div class="wrapperData d-none">${t}</div>
                  <div class="wrapperData d-none">${a?IMG_URL+a:"http://placehold.jp/100/080e17/FFFFFF/1080x1580.jpg?text="+t+"&css=%7b%22padding-left%22%3a%22140px%22%2c%22padding-right%22%3a%22140px%22%7d"}</div>
                  <div class="wrapperData d-none">false</div>
                  <div class="wrapperData d-none"></div>
                  <div class="wrapperData d-none"></div>
                  <div class="wrapperData d-none"></div>
                  <button class="addMovieBtn" onclick="recordEdit(this)">
                    <div class="addMovieBtn--text">
                      <span>
                        Aggiungi a Watchlist
                      </span>
                    </div>
                    <div class="addMovieBtn--icon">
                      <div class="svg">
                          <svg version="1.1" class="svg--element" viewBox="0 0 36 36" style="enable-background:new 0 0 36 36;" xml:space="preserve">
                              <path d="M23.2,16.5h-3.8v-3.8c0-0.8-0.7-1.5-1.5-1.5s-1.5,0.7-1.5,1.5v3.7h-3.7c-0.8,0-1.5,0.7-1.5,1.5s0.7,1.5,1.5,1.5h3.7v3.8
                            c0,0.8,0.7,1.5,1.5,1.5s1.5-0.7,1.5-1.5l0,0v-3.8h3.8c0.8,0,1.5-0.7,1.5-1.5S24,16.5,23.2,16.5L23.2,16.5z"/>
                          </svg>
                      </div>
                    </div>
                  </button>
                </div>
                <!-- <img src="${a?IMG_URL+a:"http://via.placeholder.com/1080x1580"}" alt="${title}"> -->
                <!-- <img src="${a?IMG_URL+a:"http://via.placeholder.com/1080x1580/080e17/FFFFFF?text="+title}" alt="${title}"> -->
                <img src="${a?IMG_URL+a:"http://placehold.jp/100/080e17/FFFFFF/1080x1580.jpg?text="+t+"&css=%7b%22padding-left%22%3a%22140px%22%2c%22padding-right%22%3a%22140px%22%7d"}" alt="${t}">
              </div>

              <!-- <div class="movie--info">
                  <h3>${t}</h3>
              </div> -->

            </div>
        `,main.appendChild(i)})}function pageCall(e){let t=lastUrl.split("?"),a=t[1].split("&"),i=a[a.length-1].split("=");"page"!=i[0]?getMovies(lastUrl+"&page="+e):(i[1]=e.toString(),e=i.join("="),a[a.length-1]=e,e=a.join("&"),getMovies(t[0]+"?"+e))}setGenre(),getMovies(API_URL),formSearchFilter.addEventListener("submit",e=>{e.preventDefault();e=search.value;selectedGenre=[],setGenre(),getMovies(e?searchURL+"&query="+e:API_URL),$("#btnRetrieve").click()}),prev.addEventListener("click",()=>{0<prevPage&&(pageCall(prevPage),$("#btnRetrieve").click())}),next.addEventListener("click",()=>{nextPage<=totalPages&&(pageCall(nextPage),$("#btnRetrieve").click())}),$("#filterBtn").click(function(){MicroModal.show("modalTags")}),$("#modalTags-close").click(function(){MicroModal.close("modalTags")});var request,APP_URL="https://script.google.com/macros/s/AKfycbzp1Pq-sS7DmGovbQOVT6hbZg-0wFFZpB2q77OjLTSGb-vcqA21/exec";function recordEdit(e){MicroModal.show("modalWatchlist"),$("#modalWatchlist-close").click(function(){MicroModal.close("modalWatchlist")}),resetForm();var t=[];$(e).closest(".wrapper").find("div").each(function(){t.push($(this).text())}),$("#formCreate #tid").val(t[0]),$("#formCreate #movie_id").val(t[1]),$("#formCreate #title").val(t[2]),$("#formCreate #poster_path").val(t[3]),$("#formCreate #watched").val(t[4]),$("#formCreate #link").val(t[5]),$("#formCreate #season").val(t[6]),$("#formCreate #episode").val(t[7]),$("#modalWatchlist-title").text(t[2])}function resetForm(){$("#formCreate")[0].reset()}$(window).load(function(){$("#btnRetrieve").click()}),$("#formCreate").submit(function(e){request&&request.abort();var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),$("#resultSubmit").addClass("show"),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){MicroModal.close("modalWatchlist"),$("#modalWatchlist-title").text(""),$("#resultSubmit").removeClass("show"),resetForm(),$("#btnRetrieve").click()}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()}),$("#formRetrieve").submit(function(e){request&&request.abort();var t=$(this),a=t.find("input, select, button, textarea"),t=t.serialize();a.prop("disabled",!0),(request=$.ajax({url:APP_URL,type:"post",data:t})).done(function(e,t,a){e=e.values;$.each(e,function(e,t){0==e||(1==t[4]?$("#"+t[1]).addClass("movie--watched"):$("#"+t[1]).addClass("movie--toWatch"))})}),request.fail(function(e,t,a){console.error("The following error occured: "+t,a)}),request.always(function(){a.prop("disabled",!1)}),e.preventDefault()});
//# sourceMappingURL=serie.min.js.map
